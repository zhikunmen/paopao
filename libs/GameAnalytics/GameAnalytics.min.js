var __reflect=this&&this.__reflect||function(e,n,t){e.__class__=n,t?t.push(n):t=[n],e.__types__=e.__types__?t.concat(e.__types__):t},gameanalytics;!function(e){var n;!function(e){var n;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Debug=3]="Debug"}(n||(n={}));var t=function(){function e(){e.debugEnabled=!0}return e.setInfoLog=function(n){e.instance.infoLogEnabled=n},e.setVerboseLog=function(n){e.instance.infoLogVerboseEnabled=n},e.i=function(t){if(e.instance.infoLogEnabled){var i="Info/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Info)}},e.w=function(t){var i="Warning/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Warning)},e.e=function(t){var i="Error/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Error)},e.ii=function(t){if(e.instance.infoLogVerboseEnabled){var i="Verbose/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Info)}},e.d=function(t){if(e.debugEnabled){var i="Debug/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Debug)}},e.prototype.sendNotificationMessage=function(e,t){switch(t){case n.Error:console.error(e);break;case n.Warning:console.warn(e);break;case n.Debug:"function"==typeof console.debug?console.debug(e):console.log(e);break;case n.Info:console.log(e)}},e.instance=new e,e.Tag="GameAnalytics",e}();e.GALogger=t,__reflect(t.prototype,"gameanalytics.logging.GALogger")}(n=e.logging||(e.logging={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(e){e[e.Undefined=0]="Undefined",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(n=e.EGAErrorSeverity||(e.EGAErrorSeverity={}));var t;!function(e){e[e.Undefined=0]="Undefined",e[e.Male=1]="Male",e[e.Female=2]="Female"}(t=e.EGAGender||(e.EGAGender={}));var i;!function(e){e[e.Undefined=0]="Undefined",e[e.Start=1]="Start",e[e.Complete=2]="Complete",e[e.Fail=3]="Fail"}(i=e.EGAProgressionStatus||(e.EGAProgressionStatus={}));var r;!function(e){e[e.Undefined=0]="Undefined",e[e.Source=1]="Source",e[e.Sink=2]="Sink"}(r=e.EGAResourceFlowType||(e.EGAResourceFlowType={}));var s;!function(e){var n;!function(e){e[e.Undefined=0]="Undefined",e[e.Rejected=1]="Rejected"}(n=e.EGASdkErrorType||(e.EGASdkErrorType={}));var t;!function(e){e[e.NoResponse=0]="NoResponse",e[e.BadResponse=1]="BadResponse",e[e.RequestTimeout=2]="RequestTimeout",e[e.JsonEncodeFailed=3]="JsonEncodeFailed",e[e.JsonDecodeFailed=4]="JsonDecodeFailed",e[e.InternalServerError=5]="InternalServerError",e[e.BadRequest=6]="BadRequest",e[e.Unauthorized=7]="Unauthorized",e[e.UnknownResponseCode=8]="UnknownResponseCode",e[e.Ok=9]="Ok"}(t=e.EGAHTTPApiResponse||(e.EGAHTTPApiResponse={}))}(s=e.http||(e.http={}))}(gameanalytics||(gameanalytics={}));var EGAErrorSeverity=gameanalytics.EGAErrorSeverity,EGAGender=gameanalytics.EGAGender,EGAProgressionStatus=gameanalytics.EGAProgressionStatus,EGAResourceFlowType=gameanalytics.EGAResourceFlowType,gameanalytics;!function(e){var n;!function(n){var t=e.logging.GALogger,i=function(){function e(){}return e.getHmac=function(e,n){var t=CryptoJS.HmacSHA256(n,e);return CryptoJS.enc.Base64.stringify(t)},e.stringMatch=function(e,n){return e&&n?n.test(e):!1},e.joinStringArray=function(e,n){for(var t="",i=0,r=e.length;r>i;i++)i>0&&(t+=n),t+=e[i];return t},e.stringArrayContainsString=function(e,n){if(0===e.length)return!1;for(var t in e)if(e[t]===n)return!0;return!1},e.encode64=function(n){n=encodeURI(n);var t,i,r,s,a,o="",d=0,u=0,c=0;do t=n.charCodeAt(c++),i=n.charCodeAt(c++),d=n.charCodeAt(c++),r=t>>2,s=(3&t)<<4|i>>4,a=(15&i)<<2|d>>6,u=63&d,isNaN(i)?a=u=64:isNaN(d)&&(u=64),o=o+e.keyStr.charAt(r)+e.keyStr.charAt(s)+e.keyStr.charAt(a)+e.keyStr.charAt(u),t=i=d=0,r=s=a=u=0;while(c<n.length);return o},e.decode64=function(n){var i,r,s,a,o,d="",u=0,c=0,l=0,v=/[^A-Za-z0-9\+\/\=]/g;v.exec(n)&&t.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");do s=e.keyStr.indexOf(n.charAt(l++)),a=e.keyStr.indexOf(n.charAt(l++)),o=e.keyStr.indexOf(n.charAt(l++)),c=e.keyStr.indexOf(n.charAt(l++)),i=s<<2|a>>4,r=(15&a)<<4|o>>2,u=(3&o)<<6|c,d+=String.fromCharCode(i),64!=o&&(d+=String.fromCharCode(r)),64!=c&&(d+=String.fromCharCode(u)),i=r=u=0,s=a=o=c=0;while(l<n.length);return decodeURI(d)},e.timeIntervalSince1970=function(){var e=new Date;return Math.round(e.getTime()/1e3)},e.createGuid=function(){return(e.s4()+e.s4()+"-"+e.s4()+"-4"+e.s4().substr(0,3)+"-"+e.s4()+"-"+e.s4()+e.s4()+e.s4()).toLowerCase()},e.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},e.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e}();n.GAUtilities=i,__reflect(i.prototype,"gameanalytics.utilities.GAUtilities")}(n=e.utilities||(e.utilities={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(e){var n=function(){function e(e,n,t){this.name=e,this.value=n,this.version=t}return e}();e.NameValueVersion=n,__reflect(n.prototype,"gameanalytics.device.NameValueVersion");var t=function(){function e(e,n){this.name=e,this.version=n}return e}();e.NameVersion=t,__reflect(t.prototype,"gameanalytics.device.NameVersion");var i=function(){function e(){}return e.touch=function(){},e.getRelevantSdkVersion=function(){return e.sdkGameEngineVersion?e.sdkGameEngineVersion:e.sdkWrapperVersion},e.getConnectionType=function(){return e.connectionType},e.updateConnectionType=function(){navigator.onLine?"ios"===e.buildPlatform||"android"===e.buildPlatform?e.connectionType="wwan":e.connectionType="lan":e.connectionType="offline"},e.getOSVersionString=function(){return e.buildPlatform+" "+e.osVersionPair.version},e.runtimePlatformToString=function(){return e.osVersionPair.name},e.getBrowserVersionString=function(){var n,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(0==i.length&&"ios"===e.buildPlatform)return"webkit_"+e.osVersion;if(/trident/i.test(i[1]))return n=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(n[1]||"");if("Chrome"===i[1]&&(n=t.match(/\b(OPR|Edge|UBrowser)\/(\d+)/),null!=n))return n.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(i[1]&&"fbav"===i[1].toLowerCase()&&(i[1]="facebook",i[2]))return"facebook "+i[2];var r=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"];return null!=(n=t.match(/version\/(\d+)/i))&&r.splice(1,1,n[1]),r.join(" ").toLowerCase()},e.getDeviceModel=function(){var e="unknown";return e},e.getDeviceManufacturer=function(){var e="unknown";return e},e.matchItem=function(e,n){var i,r,s,a,o,d,u=new t("unknown","0.0.0"),c=0,l=0;for(c=0;c<n.length;c+=1)if(i=new RegExp(n[c].value,"i"),s=i.test(e)){if(r=new RegExp(n[c].version+"[- /:;]([\\d._]+)","i"),a=e.match(r),d="",a&&a[1]&&(o=a[1]),o){var v=o.split(/[._]+/);for(l=0;l<Math.min(v.length,3);l+=1)d+=v[l]+(l<Math.min(v.length,3)-1?".":"")}else d="0.0.0";return u.name=n[c].name,u.version=d,u}return u},e.sdkWrapperVersion="javascript 3.1.2",e.osVersionPair=e.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new n("windows_phone","Windows Phone","OS"),new n("windows","Win","NT"),new n("ios","iPhone","OS"),new n("ios","iPad","OS"),new n("ios","iPod","OS"),new n("android","Android","Android"),new n("blackBerry","BlackBerry","/"),new n("mac_osx","Mac","OS X"),new n("tizen","Tizen","Tizen"),new n("linux","Linux","rv")]),e.buildPlatform=e.runtimePlatformToString(),e.deviceModel=e.getDeviceModel(),e.deviceManufacturer=e.getDeviceManufacturer(),e.osVersion=e.getOSVersionString(),e.browserVersion=e.getBrowserVersionString(),e.maxSafeInteger=Math.pow(2,53)-1,e}();e.GADevice=i,__reflect(i.prototype,"gameanalytics.device.GADevice")}(n=e.device||(e.device={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t=e.logging.GALogger,i=e.http.EGASdkErrorType,r=e.utilities.GAUtilities,s=function(){function n(){}return n.validateBusinessEvent=function(e,i,r,s,a){return n.validateCurrency(e)?0>i?(t.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+i),!1):n.validateShortString(r,!0)?n.validateEventPartLength(s,!1)?n.validateEventPartCharacters(s)?n.validateEventPartLength(a,!1)?n.validateEventPartCharacters(a)?!0:(t.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+a),!1):(t.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+a),!1):(t.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),!1):(t.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+s),!1):(t.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+r),!1):(t.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+e),!1)},n.validateResourceEvent=function(i,s,a,o,d,u,c){return i==e.EGAResourceFlowType.Undefined?(t.w("Validation fail - resource event - flowType: Invalid flow type."),!1):s?r.stringArrayContainsString(u,s)?a>0?o?n.validateEventPartLength(o,!1)?n.validateEventPartCharacters(o)?r.stringArrayContainsString(c,o)?n.validateEventPartLength(d,!1)?n.validateEventPartCharacters(d)?!0:(t.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+d),!1):(t.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+d),!1):(t.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+o),!1):(t.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+o),!1):(t.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+o),!1):(t.w("Validation fail - resource event - itemType: Cannot be (null)"),!1):(t.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+a),!1):(t.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+s),!1):(t.w("Validation fail - resource event - currency: Cannot be (null)"),!1)},n.validateProgressionEvent=function(i,r,s,a){if(i==e.EGAProgressionStatus.Undefined)return t.w("Validation fail - progression event: Invalid progression status."),!1;if(a&&!s&&r)return t.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),!1;if(s&&!r)return t.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),!1;if(!r)return t.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),!1;if(!n.validateEventPartLength(r,!1))return t.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+r),!1;if(!n.validateEventPartCharacters(r))return t.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+r),!1;if(s){if(!n.validateEventPartLength(s,!0))return t.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+s),!1;if(!n.validateEventPartCharacters(s))return t.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),!1}if(a){if(!n.validateEventPartLength(a,!0))return t.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+a),!1;if(!n.validateEventPartCharacters(a))return t.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+a),!1}return!0},n.validateDesignEvent=function(e,i){return n.validateEventIdLength(e)?n.validateEventIdCharacters(e)?!0:(t.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+e),!1):(t.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 32 characters or less. String: "+e),!1)},n.validateErrorEvent=function(i,r){return i==e.EGAErrorSeverity.Undefined?(t.w("Validation fail - error event - severity: Severity was unsupported value."),!1):n.validateLongString(r,!0)?!0:(t.w("Validation fail - error event - message: Message cannot be above 8192 characters."),!1)},n.validateSdkErrorEvent=function(e,r,s){return n.validateKeys(e,r)?s===i.Undefined?(t.w("Validation fail - sdk error event - type: Type was unsupported value."),!1):!0:!1},n.validateKeys=function(e,n){return r.stringMatch(e,/^[A-z0-9]{32}$/)&&r.stringMatch(n,/^[A-z0-9]{40}$/)?!0:!1},n.validateCurrency=function(e){return e&&r.stringMatch(e,/^[A-Z]{3}$/)?!0:!1},n.validateEventPartLength=function(e,n){return n&&!e?!0:e?e.length>64?!1:!0:!1},n.validateEventPartCharacters=function(e){return r.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)?!0:!1},n.validateEventIdLength=function(e){return e&&r.stringMatch(e,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)?!0:!1},n.validateEventIdCharacters=function(e){return e&&r.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)?!0:!1},n.validateAndCleanInitRequestResponse=function(e){if(null==e)return t.w("validateInitRequestResponse failed - no response dictionary."),null;var n={};try{n.enabled=e.enabled}catch(i){return t.w("validateInitRequestResponse failed - invalid type in 'enabled' field."),null}try{var r=e.server_ts;if(!(r>0))return t.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;n.server_ts=r}catch(i){return t.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof e.server_ts+", value="+e.server_ts+", "+i),null}try{var s=e.configurations;n.configurations=s}catch(i){return t.w("validateInitRequestResponse failed - invalid type in 'configurations' field. type="+typeof e.configurations+", value="+e.configurations+", "+i),null}return n},n.validateBuild=function(e){return n.validateShortString(e,!1)?!0:!1},n.validateSdkWrapperVersion=function(e){return r.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)?!0:!1},n.validateEngineVersion=function(e){return e&&r.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)?!0:!1},n.validateUserId=function(e){return n.validateString(e,!1)?!0:(t.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},n.validateShortString=function(e,n){return n&&!e?!0:!e||e.length>32?!1:!0},n.validateString=function(e,n){return n&&!e?!0:!e||e.length>64?!1:!0},n.validateLongString=function(e,n){return n&&!e?!0:!e||e.length>8192?!1:!0},n.validateConnectionType=function(e){return r.stringMatch(e,/^(wwan|wifi|lan|offline)$/)},n.validateCustomDimensions=function(e){return n.validateArrayOfStrings(20,32,!1,"custom dimensions",e)},n.validateResourceCurrencies=function(e){if(!n.validateArrayOfStrings(20,64,!1,"resource currencies",e))return!1;for(var i=0;i<e.length;++i)if(!r.stringMatch(e[i],/^[A-Za-z]+$/))return t.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+e[i]),!1;return!0},n.validateResourceItemTypes=function(e){if(!n.validateArrayOfStrings(20,32,!1,"resource item types",e))return!1;for(var i=0;i<e.length;++i)if(!n.validateEventPartCharacters(e[i]))return t.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+e[i]),!1;return!0},n.validateDimension01=function(e,n){return e?r.stringArrayContainsString(n,e)?!0:!1:!0},n.validateDimension02=function(e,n){return e?r.stringArrayContainsString(n,e)?!0:!1:!0},n.validateDimension03=function(e,n){return e?r.stringArrayContainsString(n,e)?!0:!1:!0},n.validateArrayOfStrings=function(e,n,i,r,s){var a=r;if(a||(a="Array"),!s)return t.w(a+" validation failed: array cannot be null. "),!1;if(0==i&&0==s.length)return t.w(a+" validation failed: array cannot be empty. "),!1;if(e>0&&s.length>e)return t.w(a+" validation failed: array cannot exceed "+e+" values. It has "+s.length+" values."),!1;for(var o=0;o<s.length;++o){var d=s[o]?s[o].length:0;if(0===d)return t.w(a+" validation failed: contained an empty string. Array="+JSON.stringify(s)),!1;if(n>0&&d>n)return t.w(a+" validation failed: a string exceeded max allowed length (which is: "+n+"). String was: "+s[o]),!1}return!0},n.validateFacebookId=function(e){return n.validateString(e,!1)?!0:(t.w("Validation fail - facebook id: id cannot be (null), empty or above 64 characters."),!1)},n.validateGender=function(n){if(isNaN(Number(e.EGAGender[n]))){if(n==e.EGAGender.Undefined||n!=e.EGAGender.Male&&n!=e.EGAGender.Female)return t.w("Validation fail - gender: Has to be 'male' or 'female'. Was: "+n),!1}else if(n==e.EGAGender[e.EGAGender.Undefined]||n!=e.EGAGender[e.EGAGender.Male]&&n!=e.EGAGender[e.EGAGender.Female])return t.w("Validation fail - gender: Has to be 'male' or 'female'. Was: "+n),!1;return!0},n.validateBirthyear=function(e){return 0>e||e>9999?(t.w("Validation fail - birthYear: Cannot be (null) or invalid range."),!1):!0},n.validateClientTs=function(e){return-4294967294>e||e>4294967294?!1:!0},n}();n.GAValidator=s,__reflect(s.prototype,"gameanalytics.validators.GAValidator")}(n=e.validators||(e.validators={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t,i=e.logging.GALogger;!function(e){e[e.Equal=0]="Equal",e[e.LessOrEqual=1]="LessOrEqual",e[e.NotEqual=2]="NotEqual"}(t=n.EGAStoreArgsOperator||(n.EGAStoreArgsOperator={}));var r;!function(e){e[e.Events=0]="Events",e[e.Sessions=1]="Sessions",e[e.Progression=2]="Progression"}(r=n.EGAStore||(n.EGAStore={}));var s=function(){function e(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),e.storageAvailable=!0):e.storageAvailable=!1}catch(n){}i.d("Storage is available?: "+e.storageAvailable)}return e.isStorageAvailable=function(){return e.storageAvailable},e.isStoreTooLargeForEvents=function(){return e.instance.eventsStore.length+e.instance.sessionsStore.length>e.MaxNumberOfEntries},e.select=function(n,i,r,s){void 0===i&&(i=[]),void 0===r&&(r=!1),void 0===s&&(s=0);var a=e.getStore(n);if(!a)return null;for(var o=[],d=0;d<a.length;++d){for(var u=a[d],c=!0,l=0;l<i.length;++l){var v=i[l];if(u[v[0]])switch(v[1]){case t.Equal:c=u[v[0]]==v[2];break;case t.LessOrEqual:c=u[v[0]]<=v[2];break;case t.NotEqual:c=u[v[0]]!=v[2];break;default:c=!1}else c=!1;if(!c)break}c&&o.push(u)}return r&&o.sort(function(e,n){return e.client_ts-n.client_ts}),s>0&&o.length>s&&(o=o.slice(0,s+1)),o},e.update=function(n,i,r){void 0===r&&(r=[]);var s=e.getStore(n);if(!s)return!1;for(var a=0;a<s.length;++a){for(var o=s[a],d=!0,u=0;u<r.length;++u){var c=r[u];if(o[c[0]])switch(c[1]){case t.Equal:d=o[c[0]]==c[2];break;case t.LessOrEqual:d=o[c[0]]<=c[2];break;case t.NotEqual:d=o[c[0]]!=c[2];break;default:d=!1}else d=!1;if(!d)break}if(d)for(var u=0;u<i.length;++u){var l=i[u];o[l[0]]=l[1]}}return!0},e["delete"]=function(n,i){var r=e.getStore(n);if(r)for(var s=0;s<r.length;++s){for(var a=r[s],o=!0,d=0;d<i.length;++d){var u=i[d];if(a[u[0]])switch(u[1]){case t.Equal:o=a[u[0]]==u[2];break;case t.LessOrEqual:o=a[u[0]]<=u[2];break;case t.NotEqual:o=a[u[0]]!=u[2];break;default:o=!1}else o=!1;if(!o)break}o&&(r.splice(s,1),--s)}},e.insert=function(n,t,i,r){void 0===i&&(i=!1),void 0===r&&(r=null);var s=e.getStore(n);if(s)if(i){if(!r)return;for(var a=!1,o=0;o<s.length;++o){var d=s[o];if(d[r]==t[r]){for(var u in t)d[u]=t[u];a=!0;break}}a||s.push(t)}else s.push(t)},e.save=function(){return e.isStorageAvailable()?(localStorage.setItem(e.KeyPrefix+e.EventsStoreKey,JSON.stringify(e.instance.eventsStore)),localStorage.setItem(e.KeyPrefix+e.SessionsStoreKey,JSON.stringify(e.instance.sessionsStore)),localStorage.setItem(e.KeyPrefix+e.ProgressionStoreKey,JSON.stringify(e.instance.progressionStore)),void localStorage.setItem(e.KeyPrefix+e.ItemsStoreKey,JSON.stringify(e.instance.storeItems))):void i.w("Storage is not available, cannot save.")},e.load=function(){if(!e.isStorageAvailable())return void i.w("Storage is not available, cannot load.");try{e.instance.eventsStore=JSON.parse(localStorage.getItem(e.KeyPrefix+e.EventsStoreKey)),e.instance.eventsStore||(e.instance.eventsStore=[])}catch(n){i.w("Load failed for 'events' store. Using empty store."),e.instance.eventsStore=[]}try{e.instance.sessionsStore=JSON.parse(localStorage.getItem(e.KeyPrefix+e.SessionsStoreKey)),e.instance.sessionsStore||(e.instance.sessionsStore=[])}catch(n){i.w("Load failed for 'sessions' store. Using empty store."),e.instance.sessionsStore=[]}try{e.instance.progressionStore=JSON.parse(localStorage.getItem(e.KeyPrefix+e.ProgressionStoreKey)),e.instance.progressionStore||(e.instance.progressionStore=[])}catch(n){i.w("Load failed for 'progression' store. Using empty store."),e.instance.progressionStore=[]}try{e.instance.storeItems=JSON.parse(localStorage.getItem(e.KeyPrefix+e.ItemsStoreKey)),e.instance.storeItems||(e.instance.storeItems={})}catch(n){i.w("Load failed for 'items' store. Using empty store."),e.instance.progressionStore=[]}},e.setItem=function(n,t){var i=e.KeyPrefix+n;t?e.instance.storeItems[i]=t:i in e.instance.storeItems&&delete e.instance.storeItems[i]},e.getItem=function(n){var t=e.KeyPrefix+n;return t in e.instance.storeItems?e.instance.storeItems[t]:null},e.getStore=function(n){switch(n){case r.Events:return e.instance.eventsStore;case r.Sessions:return e.instance.sessionsStore;case r.Progression:return e.instance.progressionStore;default:return i.w("GAStore.getStore(): Cannot find store: "+n),null}},e.instance=new e,e.MaxNumberOfEntries=2e3,e.KeyPrefix="GA::",e.EventsStoreKey="ga_event",e.SessionsStoreKey="ga_session",e.ProgressionStoreKey="ga_progression",e.ItemsStoreKey="ga_items",e}();n.GAStore=s,__reflect(s.prototype,"gameanalytics.store.GAStore")}(n=e.store||(e.store={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t=e.validators.GAValidator,i=e.utilities.GAUtilities,r=e.logging.GALogger,s=e.store.GAStore,a=e.device.GADevice,o=e.store.EGAStore,d=e.store.EGAStoreArgsOperator,u=function(){function n(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.commandCenterListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0}return n.setUserId=function(e){n.instance.userId=e,n.cacheIdentifier()},n.getIdentifier=function(){return n.instance.identifier},n.isInitialized=function(){return n.instance.initialized},n.setInitialized=function(e){n.instance.initialized=e},n.getSessionStart=function(){return n.instance.sessionStart},n.getSessionNum=function(){return n.instance.sessionNum},n.getTransactionNum=function(){return n.instance.transactionNum},n.getSessionId=function(){return n.instance.sessionId},n.getCurrentCustomDimension01=function(){return n.instance.currentCustomDimension01},n.getCurrentCustomDimension02=function(){return n.instance.currentCustomDimension02},n.getCurrentCustomDimension03=function(){return n.instance.currentCustomDimension03},n.getGameKey=function(){return n.instance.gameKey},n.getGameSecret=function(){return n.instance.gameSecret},n.getAvailableCustomDimensions01=function(){return n.instance.availableCustomDimensions01},n.setAvailableCustomDimensions01=function(e){t.validateCustomDimensions(e)&&(n.instance.availableCustomDimensions01=e,n.validateAndFixCurrentDimensions(),r.i("Set available custom01 dimension values: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableCustomDimensions02=function(){return n.instance.availableCustomDimensions02},n.setAvailableCustomDimensions02=function(e){t.validateCustomDimensions(e)&&(n.instance.availableCustomDimensions02=e,n.validateAndFixCurrentDimensions(),r.i("Set available custom02 dimension values: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableCustomDimensions03=function(){return n.instance.availableCustomDimensions03},n.setAvailableCustomDimensions03=function(e){t.validateCustomDimensions(e)&&(n.instance.availableCustomDimensions03=e,n.validateAndFixCurrentDimensions(),r.i("Set available custom03 dimension values: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableResourceCurrencies=function(){return n.instance.availableResourceCurrencies},n.setAvailableResourceCurrencies=function(e){t.validateResourceCurrencies(e)&&(n.instance.availableResourceCurrencies=e,r.i("Set available resource currencies: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableResourceItemTypes=function(){return n.instance.availableResourceItemTypes},n.setAvailableResourceItemTypes=function(e){t.validateResourceItemTypes(e)&&(n.instance.availableResourceItemTypes=e,r.i("Set available resource item types: ("+i.joinStringArray(e,", ")+")"))},n.getBuild=function(){return n.instance.build},n.setBuild=function(e){n.instance.build=e,r.i("Set build version: "+e)},n.getUseManualSessionHandling=function(){return n.instance.useManualSessionHandling},n.isEventSubmissionEnabled=function(){return n.instance._isEventSubmissionEnabled},n.prototype.setDefaultId=function(e){this.defaultUserId=e?e:"",n.cacheIdentifier()},n.getDefaultId=function(){return n.instance.defaultUserId},n.getSdkConfig=function(){var e,t=0;for(var i in n.instance.sdkConfig)0===t&&(e=i),++t;if(e&&t>0)return n.instance.sdkConfig;var e,t=0;for(var i in n.instance.sdkConfigCached)0===t&&(e=i),++t;return e&&t>0?n.instance.sdkConfigCached:n.instance.sdkConfigDefault},n.isEnabled=function(){var e=n.getSdkConfig();return e.enabled&&"false"==e.enabled?!1:n.instance.initAuthorized?!0:!1},n.setCustomDimension01=function(e){n.instance.currentCustomDimension01=e,s.setItem(n.Dimension01Key,e),r.i("Set custom01 dimension value: "+e)},n.setCustomDimension02=function(e){n.instance.currentCustomDimension02=e,s.setItem(n.Dimension02Key,e),r.i("Set custom02 dimension value: "+e)},n.setCustomDimension03=function(e){n.instance.currentCustomDimension03=e,s.setItem(n.Dimension03Key,e),r.i("Set custom03 dimension value: "+e)},n.setFacebookId=function(e){n.instance.facebookId=e,s.setItem(n.FacebookIdKey,e),r.i("Set facebook id: "+e)},n.setGender=function(t){n.instance.gender=isNaN(Number(e.EGAGender[t]))?e.EGAGender[t].toString().toLowerCase():e.EGAGender[e.EGAGender[t]].toString().toLowerCase(),s.setItem(n.GenderKey,n.instance.gender),r.i("Set gender: "+n.instance.gender)},n.setBirthYear=function(e){n.instance.birthYear=e,s.setItem(n.BirthYearKey,e.toString()),r.i("Set birth year: "+e)},n.incrementSessionNum=function(){var e=n.getSessionNum()+1;n.instance.sessionNum=e},n.incrementTransactionNum=function(){var e=n.getTransactionNum()+1;n.instance.transactionNum=e},n.incrementProgressionTries=function(e){var t=n.getProgressionTries(e)+1;n.instance.progressionTries[e]=t;var i={};i.progression=e,i.tries=t,s.insert(o.Progression,i,!0,"progression")},n.getProgressionTries=function(e){return e in n.instance.progressionTries?n.instance.progressionTries[e]:0},n.clearProgressionTries=function(e){e in n.instance.progressionTries&&delete n.instance.progressionTries[e];var t=[];t.push(["progression",d.Equal,e]),s["delete"](o.Progression,t)},n.setKeys=function(e,t){n.instance.gameKey=e,n.instance.gameSecret=t},n.setManualSessionHandling=function(e){n.instance.useManualSessionHandling=e,r.i("Use manual session handling: "+e)},n.setEnabledEventSubmission=function(e){n.instance._isEventSubmissionEnabled=e},n.getEventAnnotations=function(){var e={};e.v=2,e.user_id=n.instance.identifier,e.client_ts=n.getClientTsAdjusted(),e.sdk_version=a.getRelevantSdkVersion(),e.os_version=a.osVersion,e.manufacturer=a.deviceManufacturer,e.device=a.deviceModel,e.browser_version=a.browserVersion,e.platform=a.buildPlatform,e.session_id=n.instance.sessionId,e[n.SessionNumKey]=n.instance.sessionNum;var i=a.getConnectionType();return t.validateConnectionType(i)&&(e.connection_type=i),a.gameEngineVersion&&(e.engine_version=a.gameEngineVersion),n.instance.build&&(e.build=n.instance.build),n.instance.facebookId&&(e[n.FacebookIdKey]=n.instance.facebookId),n.instance.gender&&(e[n.GenderKey]=n.instance.gender),0!=n.instance.birthYear&&(e[n.BirthYearKey]=n.instance.birthYear),e},n.getSdkErrorEventAnnotations=function(){var e={};e.v=2,e.category=n.CategorySdkError,e.sdk_version=a.getRelevantSdkVersion(),e.os_version=a.osVersion,e.manufacturer=a.deviceManufacturer,e.device=a.deviceModel,e.platform=a.buildPlatform;var i=a.getConnectionType();return t.validateConnectionType(i)&&(e.connection_type=i),a.gameEngineVersion&&(e.engine_version=a.gameEngineVersion),e},n.getInitAnnotations=function(){var e={};return e.user_id=n.getIdentifier(),e.sdk_version=a.getRelevantSdkVersion(),e.os_version=a.osVersion,e.platform=a.buildPlatform,e},n.getClientTsAdjusted=function(){var e=i.timeIntervalSince1970(),r=e+n.instance.clientServerTimeOffset;return t.validateClientTs(r)?r:e},n.sessionIsStarted=function(){return 0!=n.instance.sessionStart},n.cacheIdentifier=function(){n.instance.userId?n.instance.identifier=n.instance.userId:n.instance.defaultUserId&&(n.instance.identifier=n.instance.defaultUserId),r.d("identifier, {clean:"+n.instance.identifier+"}")},n.ensurePersistedStates=function(){s.isStorageAvailable()&&s.load();var e=n.instance;e.setDefaultId(null!=s.getItem(n.DefaultUserIdKey)?s.getItem(n.DefaultUserIdKey):i.createGuid()),e.sessionNum=null!=s.getItem(n.SessionNumKey)?Number(s.getItem(n.SessionNumKey)):0,e.transactionNum=null!=s.getItem(n.TransactionNumKey)?Number(s.getItem(n.TransactionNumKey)):0,e.facebookId?s.setItem(n.FacebookIdKey,e.facebookId):(e.facebookId=null!=s.getItem(n.FacebookIdKey)?s.getItem(n.FacebookIdKey):"",e.facebookId&&r.d("facebookid found in DB: "+e.facebookId)),e.gender?s.setItem(n.GenderKey,e.gender):(e.gender=null!=s.getItem(n.GenderKey)?s.getItem(n.GenderKey):"",e.gender&&r.d("gender found in DB: "+e.gender)),e.birthYear&&0!=e.birthYear?s.setItem(n.BirthYearKey,e.birthYear.toString()):(e.birthYear=null!=s.getItem(n.BirthYearKey)?Number(s.getItem(n.BirthYearKey)):0,0!=e.birthYear&&r.d("birthYear found in DB: "+e.birthYear)),e.currentCustomDimension01?s.setItem(n.Dimension01Key,e.currentCustomDimension01):(e.currentCustomDimension01=null!=s.getItem(n.Dimension01Key)?s.getItem(n.Dimension01Key):"",e.currentCustomDimension01&&r.d("Dimension01 found in cache: "+e.currentCustomDimension01)),e.currentCustomDimension02?s.setItem(n.Dimension02Key,e.currentCustomDimension02):(e.currentCustomDimension02=null!=s.getItem(n.Dimension02Key)?s.getItem(n.Dimension02Key):"",e.currentCustomDimension02&&r.d("Dimension02 found in cache: "+e.currentCustomDimension02)),e.currentCustomDimension03?s.setItem(n.Dimension03Key,e.currentCustomDimension03):(e.currentCustomDimension03=null!=s.getItem(n.Dimension03Key)?s.getItem(n.Dimension03Key):"",e.currentCustomDimension03&&r.d("Dimension03 found in cache: "+e.currentCustomDimension03));var t=null!=s.getItem(n.SdkConfigCachedKey)?s.getItem(n.SdkConfigCachedKey):"";if(t){var a=JSON.parse(i.decode64(t));a&&(e.sdkConfigCached=a)}var d=s.select(o.Progression);if(d)for(var u=0;u<d.length;++u){var c=d[u];c&&(e.progressionTries[c.progression]=c.tries)}},n.calculateServerTimeOffset=function(e){var n=i.timeIntervalSince1970();return e-n},n.validateAndCleanCustomFields=function(e){var t={};
if(e){var s=0;for(var a in e){var o=e[a];if(a&&o)if(s<n.MAX_CUSTOM_FIELDS_COUNT){var d=new RegExp("^[a-zA-Z0-9_]{1,"+n.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(i.stringMatch(a,d)){var u=typeof o;if("string"===u||o instanceof String){var c=o;c.length<=n.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&c.length>0?(t[a]=c,++s):r.w("validateAndCleanCustomFields: entry with key="+a+", value="+o+" has been omitted because its value is an empty string or exceeds the max number of characters ("+n.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")")}else if("number"===u||o instanceof Number){var l=o;t[a]=l,++s}else r.w("validateAndCleanCustomFields: entry with key="+a+", value="+o+" has been omitted because its value is not a string or number")}else r.w("validateAndCleanCustomFields: entry with key="+a+", value="+o+" has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+n.MAX_CUSTOM_FIELDS_KEY_LENGTH+")")}else r.w("validateAndCleanCustomFields: entry with key="+a+", value="+o+" has been omitted because it exceeds the max number of custom fields ("+n.MAX_CUSTOM_FIELDS_COUNT+")");else r.w("validateAndCleanCustomFields: entry with key="+a+", value="+o+" has been omitted because its key or value is null")}}return t},n.validateAndFixCurrentDimensions=function(){t.validateDimension01(n.getCurrentCustomDimension01(),n.getAvailableCustomDimensions01())||(r.d("Invalid dimension01 found in variable. Setting to nil. Invalid dimension: "+n.getCurrentCustomDimension01()),n.setCustomDimension01("")),t.validateDimension02(n.getCurrentCustomDimension02(),n.getAvailableCustomDimensions02())||(r.d("Invalid dimension02 found in variable. Setting to nil. Invalid dimension: "+n.getCurrentCustomDimension02()),n.setCustomDimension02("")),t.validateDimension03(n.getCurrentCustomDimension03(),n.getAvailableCustomDimensions03())||(r.d("Invalid dimension03 found in variable. Setting to nil. Invalid dimension: "+n.getCurrentCustomDimension03()),n.setCustomDimension03(""))},n.getConfigurationStringValue=function(e,t){return n.instance.configurations[e]?n.instance.configurations[e].toString():t},n.isCommandCenterReady=function(){return n.instance.commandCenterIsReady},n.addCommandCenterListener=function(e){n.instance.commandCenterListeners.indexOf(e)<0&&n.instance.commandCenterListeners.push(e)},n.removeCommandCenterListener=function(e){var t=n.instance.commandCenterListeners.indexOf(e);t>-1&&n.instance.commandCenterListeners.splice(t,1)},n.getConfigurationsContentAsString=function(){return JSON.stringify(n.instance.configurations)},n.populateConfigurations=function(e){var t=e.configurations;if(t)for(var i=0;i<t.length;++i){var s=t[i];if(s){var a=s.key,o=s.value,d=s.start?s.start:Number.MIN_VALUE,u=s.end?s.end:Number.MAX_VALUE,c=n.getClientTsAdjusted();a&&o&&c>d&&u>c&&(n.instance.configurations[a]=o,r.d("configuration added: "+JSON.stringify(s)))}}n.instance.commandCenterIsReady=!0;for(var l=n.instance.commandCenterListeners,i=0;i<l.length;++i)l[i]&&l[i].onCommandCenterUpdated()},n.CategorySdkError="sdk_error",n.MAX_CUSTOM_FIELDS_COUNT=50,n.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,n.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,n.instance=new n,n.DefaultUserIdKey="default_user_id",n.SessionNumKey="session_num",n.TransactionNumKey="transaction_num",n.FacebookIdKey="facebook_id",n.GenderKey="gender",n.BirthYearKey="birth_year",n.Dimension01Key="dimension01",n.Dimension02Key="dimension02",n.Dimension03Key="dimension03",n.SdkConfigCachedKey="sdk_config_cached",n}();n.GAState=u,__reflect(u.prototype,"gameanalytics.state.GAState")}(n=e.state||(e.state={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t=e.utilities.GAUtilities,i=e.logging.GALogger,r=function(){function e(){}return e.execute=function(n,r,s,a){if(e.countMap[r]||(e.countMap[r]=0),!(e.countMap[r]>=e.MaxCount)){var o=t.getHmac(a,s),d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){if(!d.responseText)return void i.d("sdk error failed. Might be no connection. Description: "+d.statusText+", Status code: "+d.status);if(200!=d.status)return void i.w("sdk error failed. response code not 200. status code: "+d.status+", description: "+d.statusText+", body: "+d.responseText);e.countMap[r]=e.countMap[r]+1}},d.open("POST",n,!0),d.setRequestHeader("Content-Type","application/json"),d.setRequestHeader("Authorization",o);try{d.send(s)}catch(u){console.error(u)}}},e.MaxCount=10,e.countMap={},e}();n.SdkErrorTask=r,__reflect(r.prototype,"gameanalytics.tasks.SdkErrorTask")}(n=e.tasks||(e.tasks={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t=e.state.GAState,i=e.logging.GALogger,r=e.utilities.GAUtilities,s=e.validators.GAValidator,a=e.tasks.SdkErrorTask,o=function(){function e(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.baseUrl=this.protocol+"://"+this.hostName+"/"+this.version,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}return e.prototype.requestInit=function(r){var s=t.getGameKey(),a=this.baseUrl+"/"+s+"/"+this.initializeUrlPath;a="https://rubick.gameanalytics.com/v2/command_center?game_key="+s+"&interval_seconds=1000000",i.d("Sending 'init' URL: "+a);var o=t.getInitAnnotations(),d=JSON.stringify(o);if(!d)return void r(n.EGAHTTPApiResponse.JsonEncodeFailed,null);var u=this.createPayloadData(d,this.useGzip),c=[];c.push(d),e.sendRequest(a,u,c,this.useGzip,e.initRequestCallback,r)},e.prototype.sendEventsInArray=function(r,s,a){if(0==r.length)return void i.d("sendEventsInArray called with missing eventArray");var o=t.getGameKey(),d=this.baseUrl+"/"+o+"/"+this.eventsUrlPath;i.d("Sending 'events' URL: "+d);var u=JSON.stringify(r);if(!u)return i.d("sendEventsInArray JSON encoding failed of eventArray"),void a(n.EGAHTTPApiResponse.JsonEncodeFailed,null,s,r.length);var c=this.createPayloadData(u,this.useGzip),l=[];l.push(u),l.push(s),l.push(r.length.toString()),e.sendRequest(d,c,l,this.useGzip,e.sendEventInArrayRequestCallback,a)},e.prototype.sendSdkErrorEvent=function(n){if(t.isEventSubmissionEnabled()){var r=t.getGameKey(),o=t.getGameSecret();if(s.validateSdkErrorEvent(r,o,n)){var d=this.baseUrl+"/"+r+"/"+this.eventsUrlPath;i.d("Sending 'events' URL: "+d);var u="",c=t.getSdkErrorEventAnnotations(),l=e.sdkErrorTypeToString(n);c.type=l;var v=[];if(v.push(c),u=JSON.stringify(v),!u)return void i.w("sendSdkErrorEvent: JSON encoding failed.");i.d("sendSdkErrorEvent json: "+u),a.execute(d,n,u,o)}}},e.sendEventInArrayRequestCallback=function(t,r,s,a){void 0===a&&(a=null);var o=a[0],d=a[1],u=a[2],c=parseInt(a[3]),l="",v=0;l=t.responseText,v=t.status,i.d("events request content: "+l);var f=e.instance.processRequestResponse(v,t.statusText,l,"Events");if(f!=n.EGAHTTPApiResponse.Ok&&f!=n.EGAHTTPApiResponse.BadRequest)return i.d("Failed events Call. URL: "+r+", Authorization: "+o+", JSONString: "+d),void s(f,null,u,c);var g=l?JSON.parse(l):{};return null==g?void s(n.EGAHTTPApiResponse.JsonDecodeFailed,null,u,c):(f==n.EGAHTTPApiResponse.BadRequest&&i.d("Failed Events Call. Bad request. Response: "+JSON.stringify(g)),void s(f,g,u,c))},e.sendRequest=function(e,n,i,s,a,o){var d=new XMLHttpRequest,u=t.getGameSecret(),c=r.getHmac(u,n),l=[];l.push(c);for(var v in i)l.push(i[v]);if(d.onreadystatechange=function(){4===d.readyState&&a(d,e,o,l)},d.open("POST",e,!0),d.setRequestHeader("Content-Type","text/plain"),d.setRequestHeader("Authorization",c),s)throw new Error("gzip not supported");try{d.send(n)}catch(f){console.error(f.stack)}},e.initRequestCallback=function(t,r,a,o){void 0===o&&(o=null);var d=o[0],u=o[1],c="",l=0;c=t.responseText,l=t.status,i.d("init request content : "+c);var v=c?JSON.parse(c):{},f=e.instance.processRequestResponse(l,t.statusText,c,"Init");if(f!=n.EGAHTTPApiResponse.Ok&&f!=n.EGAHTTPApiResponse.BadRequest)return i.d("Failed Init Call. URL: "+r+", Authorization: "+d+", JSONString: "+u),void a(f,null,"",0);if(null==v)return i.d("Failed Init Call. Json decoding failed"),void a(n.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0);if(f===n.EGAHTTPApiResponse.BadRequest)return i.d("Failed Init Call. Bad request. Response: "+JSON.stringify(v)),void a(f,null,"",0);var g=s.validateAndCleanInitRequestResponse(v);return g?void a(n.EGAHTTPApiResponse.Ok,g,"",0):void a(n.EGAHTTPApiResponse.BadResponse,null,"",0)},e.prototype.createPayloadData=function(e,n){var t;if(n)throw new Error("gzip not supported");return t=e},e.prototype.processRequestResponse=function(e,t,r,s){return r?200===e?n.EGAHTTPApiResponse.Ok:0===e||401===e?(i.d(s+" request. 401 - Unauthorized."),n.EGAHTTPApiResponse.Unauthorized):400===e?(i.d(s+" request. 400 - Bad Request."),n.EGAHTTPApiResponse.BadRequest):500===e?(i.d(s+" request. 500 - Internal Server Error."),n.EGAHTTPApiResponse.InternalServerError):n.EGAHTTPApiResponse.UnknownResponseCode:(i.d(s+" request. failed. Might be no connection. Description: "+t+", Status code: "+e),n.EGAHTTPApiResponse.NoResponse)},e.sdkErrorTypeToString=function(e){switch(e){case n.EGASdkErrorType.Rejected:return"rejected";default:return""}},e.instance=new e,e}();n.GAHTTPApi=o,__reflect(o.prototype,"gameanalytics.http.GAHTTPApi")}(n=e.http||(e.http={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(e){var n=function(){function e(e){this.comparer=e,this._subQueues={},this._sortedKeys=[]}return e.prototype.enqueue=function(e,n){-1===this._sortedKeys.indexOf(e)&&this.addQueueOfPriority(e),this._subQueues[e].push(n)},e.prototype.addQueueOfPriority=function(e){var n=this;this._sortedKeys.push(e),this._sortedKeys.sort(function(e,t){return n.comparer.compare(e,t)}),this._subQueues[e]=[]},e.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},e.prototype.hasItems=function(){return this._sortedKeys.length>0},e.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},e.prototype.dequeueFromHighPriorityQueue=function(){var e=this._sortedKeys[0],n=this._subQueues[e].shift();return 0===this._subQueues[e].length&&(this._sortedKeys.shift(),delete this._subQueues[e]),n},e}();e.PriorityQueue=n,__reflect(n.prototype,"gameanalytics.threading.PriorityQueue")}(n=e.threading||(e.threading={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t=e.store.GAStore,i=e.store.EGAStore,r=e.store.EGAStoreArgsOperator,s=e.state.GAState,a=e.logging.GALogger,o=e.utilities.GAUtilities,d=e.http.EGAHTTPApiResponse,u=e.http.GAHTTPApi,c=e.validators.GAValidator,l=e.http.EGASdkErrorType,v=function(){function n(){}return n.addSessionStartEvent=function(){if(s.isEventSubmissionEnabled()){var e={};e.category=n.CategorySessionStart,s.incrementSessionNum(),t.setItem(s.SessionNumKey,s.getSessionNum().toString()),n.addDimensionsToEvent(e),n.addEventToStore(e),a.i("Add SESSION START event"),n.processEvents(n.CategorySessionStart,!1)}},n.addSessionEndEvent=function(){if(s.isEventSubmissionEnabled()){var e=s.getSessionStart(),t=s.getClientTsAdjusted(),i=t-e;0>i&&(a.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),i=0);var r={};r.category=n.CategorySessionEnd,r.length=i,n.addDimensionsToEvent(r),n.addEventToStore(r),a.i("Add SESSION END event."),n.processEvents("",!1)}},n.addBusinessEvent=function(e,i,r,o,d,v){if(void 0===d&&(d=null),s.isEventSubmissionEnabled()){if(!c.validateBusinessEvent(e,i,d,r,o))return void u.instance.sendSdkErrorEvent(l.Rejected);var f={};s.incrementTransactionNum(),t.setItem(s.TransactionNumKey,s.getTransactionNum().toString()),f.event_id=r+":"+o,f.category=n.CategoryBusiness,f.currency=e,f.amount=i,f[s.TransactionNumKey]=s.getTransactionNum(),d&&(f.cart_type=d),n.addDimensionsToEvent(f),n.addFieldsToEvent(f,s.validateAndCleanCustomFields(v)),a.i("Add BUSINESS event: {currency:"+e+", amount:"+i+", itemType:"+r+", itemId:"+o+", cartType:"+d+"}"),n.addEventToStore(f)}},n.addResourceEvent=function(t,i,r,o,d,v){if(s.isEventSubmissionEnabled()){if(!c.validateResourceEvent(t,i,r,o,d,s.getAvailableResourceCurrencies(),s.getAvailableResourceItemTypes()))return void u.instance.sendSdkErrorEvent(l.Rejected);t===e.EGAResourceFlowType.Sink&&(r*=-1);var f={},g=n.resourceFlowTypeToString(t);f.event_id=g+":"+i+":"+o+":"+d,f.category=n.CategoryResource,f.amount=r,n.addDimensionsToEvent(f),n.addFieldsToEvent(f,s.validateAndCleanCustomFields(v)),a.i("Add RESOURCE event: {currency:"+i+", amount:"+r+", itemType:"+o+", itemId:"+d+"}"),n.addEventToStore(f)}},n.addProgressionEvent=function(t,i,r,o,d,v,f){if(s.isEventSubmissionEnabled()){var g=n.progressionStatusToString(t);if(!c.validateProgressionEvent(t,i,r,o))return void u.instance.sendSdkErrorEvent(l.Rejected);var m,p={};m=r?o?i+":"+r+":"+o:i+":"+r:i,p.category=n.CategoryProgression,p.event_id=g+":"+m;var h=0;v&&t!=e.EGAProgressionStatus.Start&&(p.score=d),t===e.EGAProgressionStatus.Fail&&s.incrementProgressionTries(m),t===e.EGAProgressionStatus.Complete&&(s.incrementProgressionTries(m),h=s.getProgressionTries(m),p.attempt_num=h,s.clearProgressionTries(m)),n.addDimensionsToEvent(p),n.addFieldsToEvent(p,s.validateAndCleanCustomFields(f)),a.i("Add PROGRESSION event: {status:"+g+", progression01:"+i+", progression02:"+r+", progression03:"+o+", score:"+d+", attempt:"+h+"}"),n.addEventToStore(p)}},n.addDesignEvent=function(e,t,i,r){if(s.isEventSubmissionEnabled()){if(!c.validateDesignEvent(e,t))return void u.instance.sendSdkErrorEvent(l.Rejected);var o={};o.category=n.CategoryDesign,o.event_id=e,i&&(o.value=t),n.addDimensionsToEvent(o),n.addFieldsToEvent(o,s.validateAndCleanCustomFields(r)),a.i("Add DESIGN event: {eventId:"+e+", value:"+t+"}"),n.addEventToStore(o)}},n.addErrorEvent=function(e,t,i){if(s.isEventSubmissionEnabled()){var r=n.errorSeverityToString(e);if(!c.validateErrorEvent(e,t))return void u.instance.sendSdkErrorEvent(l.Rejected);var o={};o.category=n.CategoryError,o.severity=r,o.message=t,n.addDimensionsToEvent(o),n.addFieldsToEvent(o,s.validateAndCleanCustomFields(i)),a.i("Add ERROR event: {severity:"+r+", message:"+t+"}"),n.addEventToStore(o)}},n.processEvents=function(e,d){if(s.isEventSubmissionEnabled())try{var c=o.createGuid();d&&(n.cleanupEvents(),n.fixMissingSessionEndEvents());var l=[];l.push(["status",r.Equal,"new"]);var v=[];v.push(["status",r.Equal,"new"]),e&&(l.push(["category",r.Equal,e]),v.push(["category",r.Equal,e]));var f=[];f.push(["status",c]);var g=t.select(i.Events,l);if(!g||0==g.length)return a.i("Event queue: No events to send"),void n.updateSessionStore();if(g.length>n.MaxEventCount){if(g=t.select(i.Events,l,!0,n.MaxEventCount),!g)return;var m=g[g.length-1],p=m.client_ts;if(l.push(["client_ts",r.LessOrEqual,p]),g=t.select(i.Events,l),!g)return;v.push(["client_ts",r.LessOrEqual,p])}if(a.i("Event queue: Sending "+g.length+" events."),!t.update(i.Events,f,v))return;for(var h=[],S=0;S<g.length;++S){var y=g[S],E=JSON.parse(o.decode64(y.event));0!=E.length&&h.push(E)}u.instance.sendEventsInArray(h,c,n.processEventsCallback)}catch(A){a.e("Error during ProcessEvents(): "+A.stack)}},n.processEventsCallback=function(e,n,s,o){var u=[];if(u.push(["status",r.Equal,s]),e===d.Ok)t["delete"](i.Events,u),a.i("Event queue: "+o+" events sent.");else if(e===d.NoResponse){var c=[];c.push(["status","new"]),a.w("Event queue: Failed to send events to collector - Retrying next time"),t.update(i.Events,c,u)}else{if(n){var l,v=0;for(var f in n)0==v&&(l=n[f]),++v;e===d.BadRequest&&l.constructor===Array?a.w("Event queue: "+o+" events sent. "+v+" events failed GA server validation."):a.w("Event queue: Failed to send events.")}else a.w("Event queue: Failed to send events.");t["delete"](i.Events,u)}},n.cleanupEvents=function(){t.update(i.Events,[["status","new"]])},n.fixMissingSessionEndEvents=function(){if(s.isEventSubmissionEnabled()){var e=[];e.push(["session_id",r.NotEqual,s.getSessionId()]);var d=t.select(i.Sessions,e);if(d&&0!=d.length){a.i(d.length+" session(s) located with missing session_end event.");for(var u=0;u<d.length;++u){var c=JSON.parse(o.decode64(d[u].event)),l=c.client_ts,v=d[u].timestamp,f=l-v;f=Math.max(0,f),a.d("fixMissingSessionEndEvents length calculated: "+f),c.category=n.CategorySessionEnd,c.length=f,n.addEventToStore(c)}}}},n.addEventToStore=function(e){if(s.isEventSubmissionEnabled()){if(!s.isInitialized())return void a.w("Could not add event: SDK is not initialized");try{if(t.isStoreTooLargeForEvents()&&!o.stringMatch(e.category,/^(user|session_end|business)$/))return void a.w("Database too large. Event has been blocked.");var d=s.getEventAnnotations(),u=o.encode64(JSON.stringify(d));for(var c in e)d[c]=e[c];var l=JSON.stringify(d);a.ii("Event added to queue: "+l);var v={};v.status="new",v.category=d.category,v.session_id=d.session_id,v.client_ts=d.client_ts,v.event=o.encode64(JSON.stringify(d)),t.insert(i.Events,v),e.category==n.CategorySessionEnd?t["delete"](i.Sessions,[["session_id",r.Equal,d.session_id]]):(v={},v.session_id=d.session_id,v.timestamp=s.getSessionStart(),v.event=u,t.insert(i.Sessions,v,!0,"session_id")),t.isStorageAvailable()&&t.save()}catch(c){a.e("addEventToStore: error"),a.e(c.stack)}}},n.updateSessionStore=function(){if(s.sessionIsStarted()){var e={};e.session_id=s.instance.sessionId,e.timestamp=s.getSessionStart(),e.event=o.encode64(JSON.stringify(s.getEventAnnotations())),t.insert(i.Sessions,e,!0,"session_id"),t.isStorageAvailable()&&t.save()}},n.addDimensionsToEvent=function(e){e&&(s.getCurrentCustomDimension01()&&(e.custom_01=s.getCurrentCustomDimension01()),s.getCurrentCustomDimension02()&&(e.custom_02=s.getCurrentCustomDimension02()),s.getCurrentCustomDimension03()&&(e.custom_03=s.getCurrentCustomDimension03()))},n.addFieldsToEvent=function(e,n){e&&n&&Object.keys(n).length>0&&(e.custom_fields=n)},n.resourceFlowTypeToString=function(n){return n==e.EGAResourceFlowType.Source||n==e.EGAResourceFlowType[e.EGAResourceFlowType.Source]?"Source":n==e.EGAResourceFlowType.Sink||n==e.EGAResourceFlowType[e.EGAResourceFlowType.Sink]?"Sink":""},n.progressionStatusToString=function(n){return n==e.EGAProgressionStatus.Start||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Start]?"Start":n==e.EGAProgressionStatus.Complete||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Complete]?"Complete":n==e.EGAProgressionStatus.Fail||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Fail]?"Fail":""},n.errorSeverityToString=function(n){return n==e.EGAErrorSeverity.Debug||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Debug]?"debug":n==e.EGAErrorSeverity.Info||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Info]?"info":n==e.EGAErrorSeverity.Warning||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Warning]?"warning":n==e.EGAErrorSeverity.Error||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Error]?"error":n==e.EGAErrorSeverity.Critical||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Critical]?"critical":""},n.instance=new n,n.CategorySessionStart="user",n.CategorySessionEnd="session_end",n.CategoryDesign="design",n.CategoryBusiness="business",n.CategoryProgression="progression",n.CategoryResource="resource",n.CategoryError="error",n.MaxEventCount=500,n}();n.GAEvents=v,__reflect(v.prototype,"gameanalytics.events.GAEvents")}(n=e.events||(e.events={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(n){var t=e.logging.GALogger,i=e.state.GAState,r=e.events.GAEvents,s=function(){function e(){this.blocks=new n.PriorityQueue({compare:function(e,n){return e-n}}),this.id2TimedBlockMap={},t.d("Initializing GA thread..."),e.startThread()}return e.createTimedBlock=function(e){void 0===e&&(e=0);var t=new Date;t.setSeconds(t.getSeconds()+e);var i=new n.TimedBlock(t);return i},e.performTaskOnGAThread=function(t,i){void 0===i&&(i=0);var r=new Date;r.setSeconds(r.getSeconds()+i);var s=new n.TimedBlock(r);s.block=t,e.instance.id2TimedBlockMap[s.id]=s,e.instance.addTimedBlock(s)},e.performTimedBlockOnGAThread=function(n){e.instance.id2TimedBlockMap[n.id]=n,e.instance.addTimedBlock(n)},e.scheduleTimer=function(t,i){var r=new Date;r.setSeconds(r.getSeconds()+t);var s=new n.TimedBlock(r);return s.block=i,e.instance.id2TimedBlockMap[s.id]=s,e.instance.addTimedBlock(s),s.id},e.getTimedBlockById=function(n){return n in e.instance.id2TimedBlockMap?e.instance.id2TimedBlockMap[n]:null},e.ensureEventQueueIsRunning=function(){e.instance.keepRunning=!0,e.instance.isRunning||(e.instance.isRunning=!0,e.scheduleTimer(e.ProcessEventsIntervalInSeconds,e.processEventQueue))},e.endSessionAndStopQueue=function(){i.isInitialized()&&(t.i("Ending session."),e.stopEventQueue(),i.isEnabled()&&i.sessionIsStarted()&&(r.addSessionEndEvent(),i.instance.sessionStart=0))},e.stopEventQueue=function(){e.instance.keepRunning=!1},e.ignoreTimer=function(n){n in e.instance.id2TimedBlockMap&&(e.instance.id2TimedBlockMap[n].ignore=!0)},e.setEventProcessInterval=function(n){n>0&&(e.ProcessEventsIntervalInSeconds=n)},e.prototype.addTimedBlock=function(e){this.blocks.enqueue(e.deadline.getTime(),e)},e.run=function(){clearTimeout(e.runTimeoutId);try{for(var n;n=e.getNextBlock();)if(!n.ignore)if(n.async){if(!n.running){n.running=!0,n.block();break}}else n.block();return void(e.runTimeoutId=setTimeout(e.run,e.ThreadWaitTimeInMs))}catch(i){t.e("Error on GA thread"),t.e(i.stack)}t.d("Ending GA thread")},e.startThread=function(){t.d("Starting GA thread"),e.runTimeoutId=setTimeout(e.run,0)},e.getNextBlock=function(){var n=new Date;return e.instance.blocks.hasItems()&&e.instance.blocks.peek().deadline.getTime()<=n.getTime()?e.instance.blocks.peek().async&&e.instance.blocks.peek().running?e.instance.blocks.peek():e.instance.blocks.dequeue():null},e.processEventQueue=function(){r.processEvents("",!0),e.instance.keepRunning?e.scheduleTimer(e.ProcessEventsIntervalInSeconds,e.processEventQueue):e.instance.isRunning=!1},e.instance=new e,e.ThreadWaitTimeInMs=1e3,e.ProcessEventsIntervalInSeconds=8,e}();n.GAThreading=s,__reflect(s.prototype,"gameanalytics.threading.GAThreading")}(n=e.threading||(e.threading={}))}(gameanalytics||(gameanalytics={}));var gameanalytics;!function(e){var n;!function(e){var n=function(){function e(n){this.deadline=n,this.ignore=!1,this.async=!1,this.running=!1,this.id=++e.idCounter}return e.idCounter=0,e}();e.TimedBlock=n,__reflect(n.prototype,"gameanalytics.threading.TimedBlock")}(n=e.threading||(e.threading={}))}(gameanalytics||(gameanalytics={}));var CryptoJS=CryptoJS||function(e,n){var t={},i=t.lib={},r=function(){},s=i.Base={extend:function(e){r.prototype=this;var n=new r;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=n?t:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var n=this.words,t=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var r=0;e>r;r++)n[i+r>>>2]|=(t[r>>>2]>>>24-8*(r%4)&255)<<24-8*((i+r)%4);else if(65535<t.length)for(r=0;e>r;r+=4)n[i+r>>>2]=t[r>>>2];else n.push.apply(n,t);return this.sigBytes+=e,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-8*(t%4),n.length=e.ceil(t/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var t=[],i=0;n>i;i+=4)t.push(4294967296*e.random()|0);return new a.init(t,n)}}),o=t.enc={},d=o.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;e>i;i++){var r=n[i>>>2]>>>24-8*(i%4)&255;t.push((r>>>4).toString(16)),t.push((15&r).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;n>i;i+=2)t[i>>>3]|=parseInt(e.substr(i,2),16)<<24-4*(i%8);return new a.init(t,n/2)}},u=o.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;e>i;i++)t.push(String.fromCharCode(n[i>>>2]>>>24-8*(i%4)&255));return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;n>i;i++)t[i>>>2]|=(255&e.charCodeAt(i))<<24-8*(i%4);return new a.init(t,n)}},c=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(n){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t=this._data,i=t.words,r=t.sigBytes,s=this.blockSize,o=r/(4*s),o=n?e.ceil(o):e.max((0|o)-this._minBufferSize,0);if(n=o*s,r=e.min(4*n,r),n){for(var d=0;n>d;d+=s)this._doProcessBlock(i,d);d=i.splice(0,n),t.sigBytes-=r}return new a.init(d,r)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=l.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new v.HMAC.init(e,t).finalize(n)}}});var v=t.algo={};return t}(Math);!function(e){for(var n=CryptoJS,t=n.lib,i=t.WordArray,r=t.Hasher,t=n.algo,s=[],a=[],o=function(e){return 4294967296*(e-(0|e))|0},d=2,u=0;64>u;){var c;e:{c=d;for(var l=e.sqrt(c),v=2;l>=v;v++)if(!(c%v)){c=!1;break e}c=!0}c&&(8>u&&(s[u]=o(e.pow(d,.5))),a[u]=o(e.pow(d,1/3)),u++),d++}var f=[],t=t.SHA256=r.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,n){for(var t=this._hash.words,i=t[0],r=t[1],s=t[2],o=t[3],d=t[4],u=t[5],c=t[6],l=t[7],v=0;64>v;v++){if(16>v)f[v]=0|e[n+v];else{var g=f[v-15],m=f[v-2];f[v]=((g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3)+f[v-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+f[v-16]}g=l+((d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25))+(d&u^~d&c)+a[v]+f[v],m=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&s^r&s),l=c,c=u,u=d,d=o+g|0,o=s,s=r,r=i,i=g+m|0}t[0]=t[0]+i|0,t[1]=t[1]+r|0,t[2]=t[2]+s|0,t[3]=t[3]+o|0,t[4]=t[4]+d|0,t[5]=t[5]+u|0,t[6]=t[6]+c|0,t[7]=t[7]+l|0},_doFinalize:function(){var n=this._data,t=n.words,i=8*this._nDataBytes,r=8*n.sigBytes;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=e.floor(i/4294967296),t[(r+64>>>9<<4)+15]=i,n.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=r._createHelper(t),n.HmacSHA256=r._createHmacHelper(t)}(Math),function(){var e=CryptoJS,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var i=e.blockSize,r=4*i;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var s=this._oKey=t.clone(),a=this._iKey=t.clone(),o=s.words,d=a.words,u=0;i>u;u++)o[u]^=1549556828,d[u]^=909522486;s.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}})}();var gameanalytics;!function(e){var n=e.threading.GAThreading,t=e.logging.GALogger,i=e.store.GAStore,r=e.state.GAState,s=e.http.GAHTTPApi,a=e.device.GADevice,o=e.validators.GAValidator,d=e.http.EGAHTTPApiResponse,u=e.utilities.GAUtilities,c=e.events.GAEvents,l=function(){function l(){}return l.init=function(){if(a.touch(),l.methodMap.configureAvailableCustomDimensions01=l.configureAvailableCustomDimensions01,l.methodMap.configureAvailableCustomDimensions02=l.configureAvailableCustomDimensions02,l.methodMap.configureAvailableCustomDimensions03=l.configureAvailableCustomDimensions03,l.methodMap.configureAvailableResourceCurrencies=l.configureAvailableResourceCurrencies,l.methodMap.configureAvailableResourceItemTypes=l.configureAvailableResourceItemTypes,l.methodMap.configureBuild=l.configureBuild,l.methodMap.configureSdkGameEngineVersion=l.configureSdkGameEngineVersion,l.methodMap.configureGameEngineVersion=l.configureGameEngineVersion,l.methodMap.configureUserId=l.configureUserId,l.methodMap.initialize=l.initialize,l.methodMap.addBusinessEvent=l.addBusinessEvent,l.methodMap.addResourceEvent=l.addResourceEvent,l.methodMap.addProgressionEvent=l.addProgressionEvent,l.methodMap.addDesignEvent=l.addDesignEvent,l.methodMap.addErrorEvent=l.addErrorEvent,l.methodMap.addErrorEvent=l.addErrorEvent,l.methodMap.setEnabledInfoLog=l.setEnabledInfoLog,l.methodMap.setEnabledVerboseLog=l.setEnabledVerboseLog,l.methodMap.setEnabledManualSessionHandling=l.setEnabledManualSessionHandling,l.methodMap.setEnabledEventSubmission=l.setEnabledEventSubmission,l.methodMap.setCustomDimension01=l.setCustomDimension01,l.methodMap.setCustomDimension02=l.setCustomDimension02,l.methodMap.setCustomDimension03=l.setCustomDimension03,l.methodMap.setFacebookId=l.setFacebookId,l.methodMap.setGender=l.setGender,l.methodMap.setBirthYear=l.setBirthYear,l.methodMap.setEventProcessInterval=l.setEventProcessInterval,l.methodMap.startSession=l.startSession,l.methodMap.endSession=l.endSession,l.methodMap.onStop=l.onStop,l.methodMap.onResume=l.onResume,l.methodMap.addCommandCenterListener=l.addCommandCenterListener,l.methodMap.removeCommandCenterListener=l.removeCommandCenterListener,l.methodMap.getCommandCenterValueAsString=l.getCommandCenterValueAsString,l.methodMap.isCommandCenterReady=l.isCommandCenterReady,l.methodMap.getConfigurationsContentAsString=l.getConfigurationsContentAsString,"undefined"!=typeof window&&"undefined"!=typeof window.GameAnalytics&&"undefined"!=typeof window.GameAnalytics.q){var e=window.GameAnalytics.q;for(var n in e)l.gaCommand.apply(null,e[n])}},l.gaCommand=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];n.length>0&&n[0]in e.GameAnalytics.methodMap&&(n.length>1?e.GameAnalytics.methodMap[n[0]].apply(null,Array.prototype.slice.call(n,1)):e.GameAnalytics.methodMap[n[0]]())},l.configureAvailableCustomDimensions01=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("Available custom dimensions must be set before SDK is initialized"):void r.setAvailableCustomDimensions01(e)})},l.configureAvailableCustomDimensions02=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("Available custom dimensions must be set before SDK is initialized"):void r.setAvailableCustomDimensions02(e)})},l.configureAvailableCustomDimensions03=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("Available custom dimensions must be set before SDK is initialized"):void r.setAvailableCustomDimensions03(e)})},l.configureAvailableResourceCurrencies=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("Available resource currencies must be set before SDK is initialized"):void r.setAvailableResourceCurrencies(e)})},l.configureAvailableResourceItemTypes=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("Available resource item types must be set before SDK is initialized"):void r.setAvailableResourceItemTypes(e)})},l.configureBuild=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("Build version must be set before SDK is initialized."):o.validateBuild(e)?void r.setBuild(e):void t.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+e)})},l.configureSdkGameEngineVersion=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void 0:o.validateSdkWrapperVersion(e)?void(a.sdkGameEngineVersion=e):void t.i("Validation fail - configure sdk version: Sdk version not supported. String: "+e)
})},l.configureGameEngineVersion=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void 0:o.validateEngineVersion(e)?void(a.gameEngineVersion=e):void t.i("Validation fail - configure game engine version: Game engine version not supported. String: "+e)})},l.configureUserId=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return l.isSdkReady(!0,!1)?void t.w("A custom user id must be set before SDK is initialized."):o.validateUserId(e)?void r.setUserId(e):void t.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+e)})},l.initialize=function(e,i){void 0===e&&(e=""),void 0===i&&(i=""),a.updateConnectionType();var s=n.createTimedBlock();s.async=!0,l.initTimedBlockId=s.id,s.block=function(){return l.isSdkReady(!0,!1)?void t.w("SDK already initialized. Can only be called once."):o.validateKeys(e,i)?(r.setKeys(e,i),void l.internalInitialize()):void t.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+e+", secretKey: "+i)},n.performTimedBlockOnGAThread(s)},l.addBusinessEvent=function(e,t,i,r,s){void 0===e&&(e=""),void 0===t&&(t=0),void 0===i&&(i=""),void 0===r&&(r=""),void 0===s&&(s=""),a.updateConnectionType(),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!0,"Could not add business event")&&c.addBusinessEvent(e,t,i,r,s,{})})},l.addResourceEvent=function(t,i,r,s,o){void 0===t&&(t=e.EGAResourceFlowType.Undefined),void 0===i&&(i=""),void 0===r&&(r=0),void 0===s&&(s=""),void 0===o&&(o=""),a.updateConnectionType(),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!0,"Could not add resource event")&&c.addResourceEvent(t,i,r,s,o,{})})},l.addProgressionEvent=function(t,i,r,s,o){void 0===t&&(t=e.EGAProgressionStatus.Undefined),void 0===i&&(i=""),void 0===r&&(r=""),void 0===s&&(s=""),a.updateConnectionType(),n.performTaskOnGAThread(function(){if(l.isSdkReady(!0,!0,"Could not add progression event")){var e="number"==typeof o;c.addProgressionEvent(t,i,r,s,e?o:0,e,{})}})},l.addDesignEvent=function(e,t){a.updateConnectionType(),n.performTaskOnGAThread(function(){if(l.isSdkReady(!0,!0,"Could not add design event")){var n="number"==typeof t;c.addDesignEvent(e,n?t:0,n,{})}})},l.addErrorEvent=function(t,i){void 0===t&&(t=e.EGAErrorSeverity.Undefined),void 0===i&&(i=""),a.updateConnectionType(),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!0,"Could not add error event")&&c.addErrorEvent(t,i,{})})},l.setEnabledInfoLog=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){e?(t.setInfoLog(e),t.i("Info logging enabled")):(t.i("Info logging disabled"),t.setInfoLog(e))})},l.setEnabledVerboseLog=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){e?(t.setVerboseLog(e),t.i("Verbose logging enabled")):(t.i("Verbose logging disabled"),t.setVerboseLog(e))})},l.setEnabledManualSessionHandling=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){r.setManualSessionHandling(e)})},l.setEnabledEventSubmission=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){e?(r.setEnabledEventSubmission(e),t.i("Event submission enabled")):(t.i("Event submission disabled"),r.setEnabledEventSubmission(e))})},l.setCustomDimension01=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return o.validateDimension01(e,r.getAvailableCustomDimensions01())?void r.setCustomDimension01(e):void t.w("Could not set custom01 dimension value to '"+e+"'. Value not found in available custom01 dimension values")})},l.setCustomDimension02=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return o.validateDimension02(e,r.getAvailableCustomDimensions02())?void r.setCustomDimension02(e):void t.w("Could not set custom02 dimension value to '"+e+"'. Value not found in available custom02 dimension values")})},l.setCustomDimension03=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){return o.validateDimension03(e,r.getAvailableCustomDimensions03())?void r.setCustomDimension03(e):void t.w("Could not set custom03 dimension value to '"+e+"'. Value not found in available custom03 dimension values")})},l.setFacebookId=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){o.validateFacebookId(e)&&r.setFacebookId(e)})},l.setGender=function(t){void 0===t&&(t=e.EGAGender.Undefined),n.performTaskOnGAThread(function(){o.validateGender(t)&&r.setGender(t)})},l.setBirthYear=function(e){void 0===e&&(e=0),n.performTaskOnGAThread(function(){o.validateBirthyear(e)&&r.setBirthYear(e)})},l.setEventProcessInterval=function(e){n.performTaskOnGAThread(function(){n.setEventProcessInterval(e)})},l.startSession=function(){if(r.isInitialized()){var e=n.createTimedBlock();e.async=!0,l.initTimedBlockId=e.id,e.block=function(){r.isEnabled()&&r.sessionIsStarted()&&n.endSessionAndStopQueue(),l.resumeSessionAndStartQueue()},n.performTimedBlockOnGAThread(e)}},l.endSession=function(){l.onStop()},l.onStop=function(){n.performTaskOnGAThread(function(){try{n.endSessionAndStopQueue()}catch(e){}})},l.onResume=function(){var e=n.createTimedBlock();e.async=!0,l.initTimedBlockId=e.id,e.block=function(){l.resumeSessionAndStartQueue()},n.performTimedBlockOnGAThread(e)},l.getCommandCenterValueAsString=function(e,n){return void 0===n&&(n=null),r.getConfigurationStringValue(e,n)},l.isCommandCenterReady=function(){return r.isCommandCenterReady()},l.addCommandCenterListener=function(e){r.addCommandCenterListener(e)},l.removeCommandCenterListener=function(e){r.removeCommandCenterListener(e)},l.getConfigurationsContentAsString=function(){return r.getConfigurationsContentAsString()},l.internalInitialize=function(){r.ensurePersistedStates(),i.setItem(r.DefaultUserIdKey,r.getDefaultId()),r.setInitialized(!0),l.newSession(),r.isEnabled()&&n.ensureEventQueueIsRunning()},l.newSession=function(){t.i("Starting a new session."),r.validateAndFixCurrentDimensions(),s.instance.requestInit(l.startNewSessionCallback)},l.startNewSessionCallback=function(e,s){if(e===d.Ok&&s){var a=0;if(s.server_ts){var o=s.server_ts;a=r.calculateServerTimeOffset(o)}s.time_offset=a,i.setItem(r.SdkConfigCachedKey,u.encode64(JSON.stringify(s))),r.instance.sdkConfigCached=s,r.instance.sdkConfig=s,r.instance.initAuthorized=!0}else e==d.Unauthorized?(t.w("Initialize SDK failed - Unauthorized"),r.instance.initAuthorized=!1):(e===d.NoResponse||e===d.RequestTimeout?t.i("Init call (session start) failed - no response. Could be offline or timeout."):e===d.BadResponse||e===d.JsonEncodeFailed||e===d.JsonDecodeFailed?t.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):(e===d.BadRequest||e===d.UnknownResponseCode)&&t.i("Init call (session start) failed - bad request or unknown response."),null==r.instance.sdkConfig?null!=r.instance.sdkConfigCached?(t.i("Init call (session start) failed - using cached init values."),r.instance.sdkConfig=r.instance.sdkConfigCached):(t.i("Init call (session start) failed - using default init values."),r.instance.sdkConfig=r.instance.sdkConfigDefault):t.i("Init call (session start) failed - using cached init values."),r.instance.initAuthorized=!0);if(r.instance.clientServerTimeOffset=r.getSdkConfig().time_offset?r.getSdkConfig().time_offset:0,r.populateConfigurations(r.getSdkConfig()),!r.isEnabled())return t.w("Could not start session: SDK is disabled."),void n.stopEventQueue();n.ensureEventQueueIsRunning();var v=u.createGuid();r.instance.sessionId=v,r.instance.sessionStart=r.getClientTsAdjusted(),c.addSessionStartEvent();var f=n.getTimedBlockById(l.initTimedBlockId);null!=f&&(f.running=!1),l.initTimedBlockId=-1},l.resumeSessionAndStartQueue=function(){r.isInitialized()&&(t.i("Resuming session."),r.sessionIsStarted()||l.newSession())},l.isSdkReady=function(e,n,i){return void 0===n&&(n=!0),void 0===i&&(i=""),i&&(i+=": "),e&&!r.isInitialized()?(n&&t.w(i+"SDK is not initialized"),!1):e&&!r.isEnabled()?(n&&t.w(i+"SDK is disabled"),!1):e&&!r.sessionIsStarted()?(n&&t.w(i+"Session has not started yet"),!1):!0},l.initTimedBlockId=-1,l.methodMap={},l}();e.GameAnalytics=l,__reflect(l.prototype,"gameanalytics.GameAnalytics")}(gameanalytics||(gameanalytics={})),gameanalytics.GameAnalytics.init();var GameAnalytics=gameanalytics.GameAnalytics.gaCommand;!function(){var e=CryptoJS,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,i=this._map;e.clamp(),e=[];for(var r=0;t>r;r+=3)for(var s=(n[r>>>2]>>>24-8*(r%4)&255)<<16|(n[r+1>>>2]>>>24-8*((r+1)%4)&255)<<8|n[r+2>>>2]>>>24-8*((r+2)%4)&255,a=0;4>a&&t>r+.75*a;a++)e.push(i.charAt(s>>>6*(3-a)&63));if(n=i.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var t=e.length,i=this._map,r=i.charAt(64);r&&(r=e.indexOf(r),-1!=r&&(t=r));for(var r=[],s=0,a=0;t>a;a++)if(a%4){var o=i.indexOf(e.charAt(a-1))<<2*(a%4),d=i.indexOf(e.charAt(a))>>>6-2*(a%4);r[s>>>2]|=(o|d)<<24-8*(s%4),s++}return n.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();